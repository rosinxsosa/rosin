<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Play Game - Rosin</title>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-X5ZF2WZSZW"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-X5ZF2WZSZW');
    </script>
    
    <!-- Adsterra Ad Code -->
    <script type="text/javascript" src="https://www.revenuecpmgate.com/bkeuniy3?key=151caf0808922d3167985da5120e8aac"></script>
    
    <!-- Additional Ad Script -->
    <script type='text/javascript' src='//eyebrowcohabit.com/57/51/c0/5751c0582842e4d0246d9bfc787d8213.js'></script>
    
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
            width: 100%;
            overflow: hidden;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #fff;
            display: flex;
            flex-direction: column;
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 40px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            flex-shrink: 0;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-text {
            font-size: 24px;
            font-weight: 700;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .back-home {
            background: #fff;
            border: 2px solid #fff;
            color: #1a1a1a;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .back-home:hover {
            background: #e0e0e0;
            border-color: #e0e0e0;
        }

        .game-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 30px 40px;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        .game-info-bar {
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }

        .game-details {
            flex: 1;
        }

        .game-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .game-meta {
            display: flex;
            gap: 20px;
            align-items: center;
            color: rgba(255,255,255,0.7);
            font-size: 14px;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .fullscreen-btn, .newtab-btn {
            background: #fff;
            border: 2px solid #fff;
            color: #1a1a1a;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .fullscreen-btn:hover, .newtab-btn:hover {
            background: #e0e0e0;
            border-color: #e0e0e0;
        }

        .game-frame-container {
            flex: 1;
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.15);
            position: relative;
            min-height: 500px;
            display: flex;
        }

        .game-frame {
            width: 100%;
            height: 100%;
            border: none;
            flex: 1;
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top-color: #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error-message {
            text-align: center;
            padding: 40px;
            color: rgba(255,255,255,0.7);
        }

        @media (max-width: 768px) {
            html, body {
                height: 100vh;
                overflow: hidden;
            }

            .header {
                padding: 15px 20px;
                flex-shrink: 0;
            }

            .game-container {
                padding: 15px;
                flex: 1;
                min-height: 0;
            }

            .game-info-bar {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
                flex-shrink: 0;
            }

            .game-title {
                font-size: 20px;
            }

            .action-buttons {
                width: 100%;
                flex-direction: column;
            }

            .fullscreen-btn, .newtab-btn {
                width: 100%;
                justify-content: center;
            }

            .game-frame-container {
                min-height: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo-container">
            <i data-lucide="gamepad-2" width="28" height="28"></i>
            <span class="logo-text">rosin</span>
        </div>
        <a href="index.html" class="back-home">
            <i data-lucide="arrow-left" width="18" height="18"></i>
            <span>Back to Games</span>
        </a>
    </div>

    <div class="game-container">
        <div class="game-info-bar" id="gameInfoBar">
            <div class="game-details">
                <div class="game-title" id="gameTitle">
                    <i data-lucide="loader" width="28" height="28"></i>
                    <span>Loading...</span>
                </div>
                <div class="game-meta" id="gameMeta">
                    <div class="meta-item">
                        <i data-lucide="info" width="16" height="16"></i>
                        <span id="gameDescription">Loading game information...</span>
                    </div>
                </div>
            </div>
            <div class="action-buttons">
                <button class="newtab-btn" onclick="openInNewTab()">
                    <i data-lucide="external-link" width="18" height="18"></i>
                    <span>Open in New Tab</span>
                </button>
                <button class="fullscreen-btn" onclick="toggleFullscreen()">
                    <i data-lucide="maximize" width="18" height="18"></i>
                    <span>Fullscreen</span>
                </button>
            </div>
        </div>

        <div class="game-frame-container" id="gameFrameContainer">
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Loading game...</p>
            </div>
        </div>
    </div>

    <script>
        let currentGame = null;

        // Get game ID from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const gameId = urlParams.get('id');

        // Load game data
        fetch(https://cdn.jsdelivr.net/gh/rosinxsosa/rosin@master/games.json')
            .then(response => response.json())
            .then(games => {
                currentGame = games.find(game => game.id == gameId);
                
                if (currentGame) {
                    displayGame(currentGame);
                } else {
                    showError('Game not found');
                }
            })
            .catch(error => {
                console.error('Error loading game:', error);
                showError('Error loading game data');
            });

        function displayGame(game) {
            // Update page title
            document.title = `${game.name} - Rosin`;

            // Update game info
            document.getElementById('gameTitle').innerHTML = `
                <i data-lucide="${getCategoryIcon(game.category)}" width="28" height="28"></i>
                <span>${game.name}</span>
            `;

            document.getElementById('gameMeta').innerHTML = `
                <div class="meta-item">
                    <i data-lucide="tag" width="16" height="16"></i>
                    <span>${game.category}</span>
                </div>
                <div class="meta-item">
                    <i data-lucide="user" width="16" height="16"></i>
                    <span>${game.creator}</span>
                </div>
                <div class="meta-item">
                    <i data-lucide="info" width="16" height="16"></i>
                    <span>${game.description}</span>
                </div>
            `;

            // Load game iframe
            const iframe = document.createElement('iframe');
            iframe.className = 'game-frame';
            iframe.src = game.url;
            iframe.allowFullscreen = true;
            iframe.allow = "fullscreen; gamepad; microphone; camera";
            
            const container = document.getElementById('gameFrameContainer');
            const loading = document.getElementById('loading');
            
            iframe.onload = () => {
                loading.style.display = 'none';
            };

            container.appendChild(iframe);

            // Reinitialize Lucide icons
            lucide.createIcons();
        }

        function getCategoryIcon(category) {
            const icons = {
                'Action': 'zap',
                'Adventure': 'map',
                'Arcade': 'joystick',
                'Racing': 'car',
                'Sports': 'trophy',
                'Puzzle': 'puzzle',
                'Strategy': 'brain',
                'Simulation': 'settings',
                'Platform': 'layers',
                'Music': 'music',
                'Horror': 'skull',
                'Multiplayer': 'users',
                'Other': 'gamepad-2'
            };
            return icons[category] || 'gamepad-2';
        }

        function toggleFullscreen() {
            const container = document.getElementById('gameFrameContainer');
            
            if (!document.fullscreenElement) {
                container.requestFullscreen().catch(err => {
                    console.error('Error attempting to enable fullscreen:', err);
                });
            } else {
                document.exitFullscreen();
            }
        }

        function openInNewTab() {
            if (currentGame && currentGame.url) {
                // Open the game HTML file directly in a new tab
                const gameUrl = currentGame.url.startsWith('/') ? currentGame.url : `/${currentGame.url}`;
                window.open(gameUrl, '_blank', 'noopener,noreferrer');
            }
        }

        function showError(message) {
            const container = document.getElementById('gameFrameContainer');
            container.innerHTML = `
                <div class="error-message">
                    <i data-lucide="alert-circle" width="48" height="48"></i>
                    <h2 style="margin: 20px 0 10px;">${message}</h2>
                    <p>Please try another game or return to the games list.</p>
                </div>
            `;
            lucide.createIcons();
        }

        // Initialize Lucide icons
        lucide.createIcons();
    </script>
</body>
</html>
